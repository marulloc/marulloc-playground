
> Next.js는 CSR, SSR, SSG 모두를 지원한다. 

# CSR (Client Side Rendering)
---
> CSR은 클라이언트에서 페이지를 렌더링 하는 방식이다.
> SPA 페이지 구성 방식을 적용하는 곳에선 CSR 렌더링 방식을 채택한다 


##### 렌더링 순서
1. HTML 빈 껍데기만 받아온 후 
2. 웹앱 전체에 필요한 JS,CSS 리소스를 초반에 모두 다운로드한다.
3. 그리고 JS를 이용해 HTML에 요소들을 동적으로 붙여나가면서 페이지를 만든다.
- 그 이후 새로운 페이지 요청이 있을땐, 
	- 내부적으로 라우팅하고
	- 페이지 갱신에 필요한 데이터만 받아서 페이지를 업데이트 한다.


##### 장단점
- 모든 리소스를 처음에 다 받아오므로 - 초기 로딩 속도가 느리다
- 빈 뼈대만 받고, JS를 받은 이후에, 요소가 추가되기 때문에 - FCP가 느리다. 유저가 체감하기에 느리다
- 대신, 초기로딩 이후 구동속도가 빠르다.
- 클라이언트 사이드에서 연산과 라우팅을 하기 때문에, 반응속도가 빠르고 UX가 우수하다.
- 리소스를 전달해주는 서버측 부하가 적다.
- 대신, 최신에는 고도화 되었다고는 하지만, 크롤링봇들은 빈 뼈대의 HTML을 수집하여 의미있는 데이터를 확인하기 어렵고 이에 SEO에 불리하다.

##### 단점 극복 방법
- 초기로딩속도 극복 방법 
	- Code Splitting 으로 레이지로딩하기
	- Tree-Shaking으로 번들 사이즈 줄이기를 통해
	- 번들 사이즈를 줄여 초기 로딩속도를 보완할 수 있다.
- SEO 강화 방법
	- pre-rendering을 통해 , 크롤러가 요청하는 것이라면 미리 구성해둔 HTML 파일을 건내주는 방법




# SSR (Server Side Rendering)
---
> SSR은 서버에서 페이지를 렌더링 하는 방식
> MPA 페이지 구성 방식을 적용하는 곳에선 SSR 렌더링 방식을 채택한다. 


##### 렌더링 순서
1. 페이지 요청이 있으면, 서버에서는 필요한 데이터를 서버단에서 로드하여, 의미있는 HTML과 페이지에 필요한 JS를 넘겨준다.
2. 브라우저는 어느정도 구성된 HTML을 먼저 보여주고
3. JS 코드를 다운로드 받은 이후, JS 코드를 HTML에 연결`Hydration`한다.


##### 장단점
- 기본적으로 HTML에 의미있는 데이터가 담긴채로 서버에 존재하기 때문에 SEO에 좋다.
- JS코드를 받기 전에, 어느정도 그려진 화면을 보기때문에 FCP에는 좋다. 
	- 그러나 아직 hydration이 완료되지 않아 인터랙션을 할 수 없는 단점이 존재한다.
	- JS가 실행되고 이벤트핸들러가 부착되기 전까지는 인터랙션 할 수 없다. 
		- 즉 Time to View !== Time to Interact 때문에 UX를 저하시킬 수 있다.
- 그리고 서버에서 많은 작업을 하기 때문에 서버 부하가 CSR보다 크다.
- 또 서버에서 직접 구동되어야 하다보니 CDN을 통한 캐시를 할 수 없다.

##### Next에서 사용법
- getServerSideProps



# SSG (Static Site Generation)
---
> 빌드타임에 서버에서 한 번 생성되는 페이지로, 미리 만들어두면 거의 바뀔 일 없는 페이지에 적합하다.


##### 렌더링 순서
- 페이지 요청이 있으면, 서버에서는 빌드타임에 생성해둔 페이지를 그대로 전달한다.
- 브라우저는 바로 그린다.

##### 장단점
- 서버에서 생성된 HTML만 받아서 바로 보여줄 수 있어서  로딩 속도가 빠르고
	- 서버 부하가 적다
	- 추가적인 JS 번들 로드가 없어서 TTV === TTL이기도 하다. 
- 서버에서 미리 생성되어 있으므로 SEO에도 좋다.
- 동적으로 생성되는 페이지가 아니기 때문에 CDN을 사용 할 수도 있다. 
- 그러나 동적인 컨텐츠를 적용하기 어렵기 때문에, 사용자 상호작용이 많은 경우에 적합하지 않다.


> Next12 : getStaticProps - 다이나믹라우트의 경우엔 getStaticPaths 까지 써주면 됨
> Next13 : generateStaticParams

##### Next에서 사용법
- Next12
	- getStaticProps
	- 다이나믹 라우트인 경우엔 getStaticPaths도 함께 쓴다.
		- fallback 옵션 미리 생성되지 않은 페이지에 접근했을 경우 해결방식 정의
			- true : Fallback 페이지를 제공
			- false : 404페이지로 이동 
			- blocking : SSR로 작동
- Next13
	- generateStaticParams


#### ISR(Incremental Static Regeneration) 
---
> 증분 정적 재생성은 런타임 중에 정적 페이지를 리빌드 하는 것으로 SSG와 SSR의 하이브리드다.


- 서버는 빌드타임에 페이지를 미리 생성해둔다. 
- 사용자 요청이 오면 빌드타임에 생성된 페이지를 건내준다.
	- revalidation : 10으로 설정했다면, 
		- 요청을 수행한 후 10초 후에 페이지 빌드를 시작한다.
		- 페이지 빌드가 완료되면 이전 페이지를 지우고 새로운 페이지로 만든다.
- on-demand-revalidation
	- next api route를 이용해 api요청을 보내면
	- route handler가 페이지를 revalidate 하는 방식이라네 

- 컨텐츠가 동적이지만 자주 변경되지 않는 사이트의 경우에 추천한다. 
